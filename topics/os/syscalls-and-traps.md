### Syscalls, Traps, and Interrupts

#### 1. System Calls (syscalls)
- **Definition**: The interface between user programs and the OS kernel.  
- A *controlled entry point* for user applications to request privileged operations (I/O, process creation, memory mgmt).  
- Typically implemented as a **software interrupt (trap)** or a special CPU instruction.

**Example:**
- `read()`, `write()`, `open()`, `fork()` in Unix/Linux.
- User code → executes `int 0x80` (x86) or `syscall` instruction → CPU switches to **kernel mode**.

---

#### 2. Traps
- **Definition**: A *synchronous* exception generated by the CPU during program execution.  
- Caused by the current instruction (predictable).
- Used both for:
  - **System calls** (intentional trap).
  - **Errors** (divide by zero, invalid memory access → segfault).

**Key point**: Control is transferred to the OS kernel’s trap handler.

---

#### 3. Interrupts
- **Definition**: An *asynchronous* signal from hardware or the system timer that diverts CPU execution to handle an event.
- Triggered by **external devices** (disk I/O done, packet received, timer tick).
- CPU suspends current execution, saves state, runs interrupt handler, then resumes.

---

#### Comparison

| Aspect          | **Syscall**                        | **Trap**                                  | **Interrupt**                          |
|-----------------|------------------------------------|-------------------------------------------|-----------------------------------------|
| Triggered by    | User program request               | Fault/error in current instruction OR syscall | External device or timer event          |
| Synchronous?    | Yes                                | Yes                                        | No (asynchronous)                       |
| Typical use     | File I/O, process control, network | Divide by zero, page fault, `syscall` instruction | Keyboard press, disk completion, clock tick |
| Mode switch     | User → Kernel                      | User → Kernel                              | User/Kernel → Kernel                    |

---

#### Example Flow

1. **Syscall**: App calls `write(fd, buf, len)` → trap instruction → kernel writes to disk.  
2. **Trap (fault)**: Program divides by zero → CPU traps → kernel delivers `SIGFPE`.  
3. **Interrupt**: Network card finishes receiving a packet → sends interrupt → kernel copies packet into memory.

